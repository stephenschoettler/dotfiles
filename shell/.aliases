#!/bin/bash
# .aliases file

################################################################################
# EZA ALIASES
################################################################################
# Mnemonic System:
#   l  -> Long format (-l)
#   a  -> All files, including hidden (-a)
#   t  -â€º Tree view (-T)
#   h  -â€º Human-readable file sizes (-h)
#   g  -â€º Git status (--git)
#   s  -â€º Sort by... (followed by another letter)
#   o  -â€º Octal permissions (--octal-permissions)
#
# Examples:
#   'la'  -> List All files
#   'll'  -> Long List
#   'lla' -> Long List All files
#   'lt'  -> List in a Tree view
#   'lts' -> List Tree, sorted by Size
################################################################################

########################################
# Base ls Replacement
########################################
# Your default `ls` command. The foundation for other aliases.
alias ls='eza --icons --group-directories-first --color=auto'

########################################
# Core Listing Aliases
########################################
# Show all files (including hidden) in a simple list.
alias la='ls -a'

# The classic "long list" format.
alias l='ls -lh'
alias ll='ls -lah'

# Long list, but with human-readable file sizes (e.g., 4.2K, 1.3M).
alias lh='ls -lh'

# The most common detailed view: Long list, All files, Human-readable.
alias lla='ls -lah'
alias llh='ls -lah' # Common alternative for the same command

# List only directories, long format, human-readable.
alias lld='ls -lhD'

# lsz â€” list files by size, human-readable, minimal info
# Usage: lsz -b [path] (largestâ†’smallest) | lsz -s [path] (smallestâ†’largest)
lsz() {
  case "$1" in
  # Standardized 'eza' to 'exa' for consistency
  -l)
    shift
    eza --only-files -lh --no-permissions --no-user --no-time --sort=size --reverse "${@:-.}"
    ;;
  -s)
    shift
    eza --only-files -lh --no-permissions --no-user --no-time --sort=size "${@:-.}"
    ;;
  *) echo "Usage: lsz -l [path] (largestâ†’smallest) | lsz -s [path] (smallestâ†’largest)" ;;
  esac
}

########################################
# Tree Views
########################################
# Standard tree view.
alias lt='ls -T'

# Tree view including hidden files.
alias lta='ls -Ta'

# Tree view with all files using tree command.
alias llt='tree -a'

# Tree view with specified depth.
alias lt1='ls -T --level=1'
alias lt2='ls -T --level=2'
alias lt3='ls -T --level=3'

########################################
# Sorting Aliases (builds on `ll`)
########################################
# Long list, sorted by newest modified date first.
alias lsn='ll --sort=newest'

# Long list, sorted by oldest modified date first.
alias lso='ll --sort=oldest'

# Long list, sorted by file size (largest first).
alias lss='ll --sort=size'

# Long list, sorted by file extension.
alias lse='ll --sort=extension'

########################################
# Special Integrations (builds on `ll`)
########################################
# Long list with Git status.
alias lg='ll --git'

# Long list with Git status for all files.
alias lga='lla --git'

# Long list with file permissions shown in octal format.
alias lo='ll --octal-permissions'

# Long list, octal permissions, and human-readable sizes.
alias loh='lh --octal-permissions'

########################################
# Bash
########################################
alias reload='source ~/.zshrc'

########################################
# Navigation
########################################
alias ..='cd ..'
alias ...='cd ../..'
alias ....='cd ../../..'

cp..() { cp -i "$@" ..; }
cp...() { cp -i "$@" ../..; }
cp....() { cp -i "$@" ../../..; }

mv..() { mv -i "$@" ..; }
mv...() { mv -i "$@" ../..; }
mv....() { mv -i "$@" ../../..; }

########################################
# Terminal
########################################
#alias c='clear && colorscript --exec crunchbang-mini'
alias c='clear'

########################################
# History
########################################
alias h='history | tail -10'
alias hc='history -c'
alias r='!!'
alias hr='!'
alias hgrep='history | grep'

########################################
# Brightness (Fixed & Robust)
########################################

# --- 1. Detection Logic ---

_get_internal() {
  # 1. Try standard laptop names (eDP/LVDS)
  local screen=$(xrandr --query | grep " connected" | grep -E "^eDP|^LVDS" | head -n 1 | cut -d ' ' -f1)

  # 2. Fallback: If not found, try the "primary" monitor
  if [ -z "$screen" ]; then
    screen=$(xrandr --query | grep " connected" | grep "primary" | head -n 1 | cut -d ' ' -f1)
  fi

  # 3. Desperation: Take the first thing that isn't HDMI
  if [ -z "$screen" ]; then
    screen=$(xrandr --query | grep " connected" | grep -v "HDMI" | head -n 1 | cut -d ' ' -f1)
  fi

  echo "$screen"
}

_get_external() {
  # Grab the HDMI screen (since we know that works) or anything that isn't the internal one
  local internal=$(_get_internal)
  xrandr --query | grep " connected" | grep -v "^$internal" | head -n 1 | cut -d ' ' -f1
}

# --- 2. The Core Math Function ---
_adjust_brightness() {
  local display="$1"
  local step="$2"

  # 1. Safety Check: Ensure we have a display and a step
  if [ -z "$display" ] || [ -z "$step" ]; then
    echo "âŒ Usage: _adjust_brightness [display] [step] (e.g., +0.1)"
    return 1
  fi

  # 2. Get Brightness: Uses awk to find the device block and extract brightness strictly from that block
  local current=$(xrandr --verbose | awk -v disp="$display" '$0 ~ "^"disp {f=1; next} /^[^\t ]/ {f=0} f && /Brightness/ {print $2; exit}')

  # Fallback
  if [ -z "$current" ]; then current=1.0; fi

  # 3. Math Time: Removed the extra "+" sign.
  # Since $step includes the sign (+0.1 or -0.1), we just concatenate them.
  # Example: "0.7 +0.1" or "0.7 -0.1"
  local new_val=$(echo "$current $step" | bc)

  # 4. Caps (0.1 - 1.0)
  if (($(echo "$new_val > 1.0" | bc -l))); then new_val=1.0; fi
  if (($(echo "$new_val < 0.1" | bc -l))); then new_val=0.1; fi

  # 5. Apply
  xrandr --output "$display" --brightness "$new_val"
  echo "ðŸ’¡ ${display} brightness: $new_val"
}

# Set Brightness Absolute (Usage: sb 0.5)
sb() {
  local val="$1"
  # Default to internal display
  local display=$(_get_internal)

  # Safety: Ensure a value was provided
  if [ -z "$val" ]; then
    echo "âŒ Usage: sb 0.5 (Sets brightness to 50%)"
    return 1
  fi

  # Apply
  xrandr --output "$display" --brightness "$val"
  echo "ðŸ’¡ Brightness set to $val on $display"
}
# --- 3. Aliases ---

# Laptop (Internal)
alias bup='brightnessctl s +10%'
alias bdown='brightnessctl s 10%-'

# Monitor (External)
alias mbup='_adjust_brightness $(_get_external) +0.1'
alias mbdown='_adjust_brightness $(_get_external) -0.1'

# Sync (Both)
alias ballup='bup; mbup'
alias balldown='bdown; mbdown'

# Reset
alias max_brightness='xrandr --output $(_get_internal) --brightness 1.0; xrandr --output $(_get_external) --brightness 1.0'

########################################
# Misc
########################################
alias fetch='fastfetch'
alias top='btop'
alias ping='ping -c 5'
# Alias for showing disk space in human-readable format.
alias df='df -h'
# alias dim='xrandr --output DP-2 --brightness 0.7'
# alias bright='xrandr --output DP-2 --brightness 1.0'
alias ffmpeg="/usr/bin/ffmpeg"
alias tmux-reload='tmux source-file ~/.tmux.conf && tmux display-message "Config reloaded âœ”"'

########################################
# OpenCode
########################################
alias ask='opencode run --model openrouter/google/gemini-2.0-flash-exp:free'

########################################
# Aliases for pikaur
########################################
# 1. Update and Upgrade System
alias pi='pikaur -Syu'

# 2. Search for a Package
alias pis='pikaur -Ss'

# 3. Install a Package
alias pii='pikaur -S'

# 4. Remove a Package
alias pir='pikaur -R'

# 5. Remove a Package and Unused Dependencies
alias pirn='pikaur -Rns'

# 6. Upgrade Only AUR Packages
alias piu='pikaur -Sua'

# 7. Clean Cache
alias pic='pikaur -Sc'

# 8. Show Orphans
alias pio='pikaur -Qdt'

# 9. Remove All Orphans
alias pior='pikaur -Rns $(pikaur -Qdtq)'

# 10. View Installed Packages
alias piq='pikaur -Q'
alias piqs='pikaur -Qs'
alias piqi='pikaur -Qi'

# 11. View AUR Packages Installed
alias pia='pikaur -Qm'

# 12. Get Info on a Specific Package
alias pinfo='pikaur -Qi'

# 13. List Files Installed by a Package
alias pil='pikaur -Ql'

# 14. Clean Unused Dependencies
alias pid='pikaur -R $(pikaur -Qdtq)'

# 15. Download Package without Installing
alias pidown='pikaur -Sw'

# 16. Edit a PKGBUILD Before Installing
alias pie='pikaur --edit'

# 17. Check for Outdated Packages
alias piout='pikaur -Qum'

# 18. Show Package Dependencies
alias pdep='pikaur -Si'

########################################
# Plex Sync
########################################
rsmovies() {
  rsync -avh --progress "$@" w0lf@192.168.68.66:/mnt/media/Movies/
  # Check for rsync failure
  if [ $? -ne 0 ]; then
    echo "ðŸš¨ Rsync failed for Movies. Check connectivity, permissions, and IP (192.168.68.66)." >&2
  fi
}

rstv() {
  rsync -avh --progress "$@" w0lf@192.168.68.66:/mnt/media/TV/
  # Check for rsync failure
  if [ $? -ne 0 ]; then
    echo "ðŸš¨ Rsync failed for TV. Check connectivity, permissions, and IP (192.168.68.66)." >&2
  fi
}

rsmusic() {
  rsync -avh --progress "$@" w0lf@192.168.68.66:/mnt/media/Music/
  # Check for rsync failure
  if [ $? -ne 0 ]; then
    echo "ðŸš¨ Rsync failed for Music. Check connectivity, permissions, and IP (192.168.68.66)." >&2
  fi
}

########################################
# Apple Superdrive
########################################

spititout() {
  drive=$(lsblk -ndo NAME,TYPE | awk '$2 == "rom" {print "/dev/"$1; exit}')
  if [ -n "$drive" ]; then
    echo "âï¸Ejecting $driveâ€¦ ðŸ’¿"
    eject "$drive"
  else
    echo "No optical drive found." >&2
  fi
}

########################################
# Safety
########################################
alias mv='mv -i' # prompt before overwrite
alias cp='cp -i' # prompt before overwrite
alias rm='rm -i' # prompt before delete

########################################
# Clear File
########################################
alias clf='truncate -s 0'
